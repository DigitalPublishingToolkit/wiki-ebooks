<!DOCTYPE html>
<html>
<head>
  <title>Revisions & Contributions</title>
  <meta charset="utf-8">
  <script src="json/jquery-2.1.3.min.js"></script>
</head>
<body>
  <h2 id="myTitle"></h2>
  <ul id="myRevisions">
  </ul>

  <h2 id="myTitleContrib"></h2>
  <ul id="myContributions">
  </ul>

  <hr>
  <div id="myRevisionsTxt"></div>
</body>
<script>
$(document).ready(function(){

  var proj = "https://en.wikipedia.org";
  var page = "Etherpad"; //Apache Wave

  //var jsonFile = 'json/revisions.json';

  var jsonFile = proj+"/w/api.php?action=query&titles="+page+"&prop=contributors|revisions&rvprop=timestamp|user|comment&rvlimit=10&format=json&callback=?";


    $.getJSON( jsonFile, function(data) {
        //console.log( "done and assuming that page exists");
        var pages = data.query.pages;
        var myTitle = pages[Object.keys(pages)[0]].title;
        var contribArray = pages[Object.keys(pages)[0]].contributors;
        var revisionsArray = pages[Object.keys(pages)[0]].revisions;

        //console.log(contribArray.length);

        $('#myTitle').text('Wikipedia EN ' +myTitle + ' Revisions');

        for(var o = 0; o < revisionsArray.length; o++){
            console.log(revisionsArray[o].user);
            console.log(revisionsArray[o].timestamp);
            console.log(revisionsArray[o].comment);
            $('#myRevisions').append('<li>'+revisionsArray[o].timestamp+', '+revisionsArray[o].user+' <strong>'+revisionsArray[o].comment+'</strong></li>');
        }

        //Contributions
        $('#myTitleContrib').text('Wikipedia EN ' +myTitle + ' Contributions');

        for(var o = 0; o < contribArray.length; o++){
            console.log(contribArray[o].name);
            $('#myContributions').append('<li>'+contribArray[o].name+'</li>');

        }

        //Txt
        $('#myRevisionsTxt').text('<ul>'+$('#myRevisions').html()+'</ul>');

      });


});
</script>
</html>
